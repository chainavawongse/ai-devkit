---
name: generating-agent-documentation
description: Generate comprehensive CLAUDE.md documentation to enable effective AI-agent collaboration. Recursively analyze repository structure, discover modules and their tooling, interactively confirm with user, and create hierarchical documentation describing architecture, patterns, and complete tooling stacks that AI agents need to work effectively in the codebase.
when_to_use: when setting up AI collaboration documentation for a repository, enabling AI agents to understand the codebase structure and tooling, onboarding to a project, or needing to document high-level architecture and patterns for AI-assisted development
version: 2.1.0
---

# Generating Agent Documentation

Systematically analyze repository structure, discover modules, and generate comprehensive CLAUDE.md documentation that enables effective AI-agent collaboration.

**Core principle:** Understand before documenting. Confirm with humans before writing. **NEVER SPECULATE** - only document what you can verify from the codebase.

**Purpose:** Create documentation specifically designed for AI agents to understand and work effectively within a codebase. The CLAUDE.md files serve as context for AI-assisted development.

## When to Use

**Use this skill when:**

- Starting work on a new, unfamiliar repository
- Setting up AI collaboration documentation for the first time
- Refreshing outdated CLAUDE documentation after significant changes
- Onboarding to a project

**Don't use when:**

- Making minor corrections to existing docs (just edit directly)
- Working on a single-file or very simple project

## Core Principles

**Before creating ANY documentation:**

1. **Minimal by default**: Start with CLAUDE.md only
2. **Ask when unsure**: If you're not certain whether a separate file adds value, ask the user
3. **Tightly scoped**: Each file should have a clear, focused purpose
4. **No assumptions**: Only document what you can verify by reading actual files
5. **Usage-focused**: Top-level CLAUDE.md should answer "how do I use this?" not "how is this built?"

**CLAUDE.md Focus (Repository and Module Level):**

The main CLAUDE.md file should be tightly focused on **usage**:

- Key `just` commands to run common tasks
- Project management details (JIRA project ID)
- High-level "what is this" overview (2-3 sentences max)
- Entry points and how to get started
- Link to other documentation files (if they exist)

**NOT in CLAUDE.md:**

- Detailed architecture explanations (use CLAUDE-architecture.md if needed)
- Code patterns and conventions (use CLAUDE-patterns.md if needed)
- Testing strategies (use CLAUDE-testing.md if needed)
- Long explanations of how things work

## The Workflow

### 0. Check for Existing Documentation

```bash
# Find all CLAUDE files
find . -name "CLAUDE*.md" | sort
```

**If CLAUDE files exist:** Switch to UPDATE mode (see `reference/update-guide.md`)
**If no CLAUDE files exist:** Proceed with initial setup

### 1. Initial Repository Scan

Start with `tree` command for fast, visual understanding:

```bash
# Get comprehensive directory structure (limit depth for readability)
tree -L 3 -d -I 'node_modules|.git|__pycache__|.venv|venv|dist|build|target'

# Show files too (with size limits)
tree -L 2 -I 'node_modules|.git|__pycache__|.venv|venv|dist|build|target' | head -100
```

Then identify key files:

```bash
# Look for package managers and build configs
find . -maxdepth 3 -type f -name "package.json" -o -name "pom.xml" -o -name "Cargo.toml" -o -name "go.mod" -o -name "pyproject.toml"

# Identify infrastructure and config
find . -maxdepth 2 -type f -name "Dockerfile" -o -name "docker-compose.yml" -o -name "justfile"
```

### 2. Module Discovery

**Use TodoWrite to create todos for each discovery task:**

- [ ] Scan root directory structure
- [ ] Identify frontend modules
- [ ] Identify backend modules
- [ ] Identify infrastructure code
- [ ] Identify shared/common libraries
- [ ] Identify tooling for EACH module
- [ ] Document versions for key tools

**For detailed detection commands, see:** `reference/detection-guide.md`

### 3. Deep Module Analysis

For each discovered module, gather:

**Technology Stack & Tooling:**

- Language(s) and version
- Framework(s)
- Package Manager
- Build Tool
- Testing Framework
- Linting/Formatting tools
- Database/ORM tools

**How to identify tooling:**

```bash
# Check package files
cat package.json           # Node.js tooling
cat pyproject.toml         # Python tooling
cat Cargo.toml            # Rust tooling
cat go.mod                # Go tooling

# Check configuration files
ls -la | grep -E "eslint|prettier|ruff|mypy|pytest|jest"
```

### 4. Interactive Confirmation

**CRITICAL: Always confirm your findings with the user before generating documentation.**

**ANTI-SPECULATION RULES:**

- Only document what you can verify by reading actual files
- If you cannot find clear evidence of something, ASK the user instead of guessing
- Do not infer future plans or intentions - only document what exists now
- Mark any uncertain information with "Needs verification:" prefix when presenting to user

Use AskUserQuestion tool to present discovered structure:

```markdown
I've analyzed the repository and identified the following modules:

1. **frontend/** - React application
   - Language: TypeScript 5.2
   - Framework: React 18, Next.js 14
   - Package Manager: pnpm
   - Testing: Vitest

2. **backend/api/** - REST API
   - Language: Python 3.11
   - Framework: FastAPI 0.104
   - Package Manager: uv
   - Testing: pytest

**Questions:**
1. Does this match your understanding of the project structure?
2. Are there any modules I missed?
3. Should any of these be split or combined differently?
```

### 5. Decide Which Documentation Files to Create

**CRITICAL: Start minimal. Create CLAUDE.md first, then ask about additional files.**

**Decision Framework:**

After creating CLAUDE.md, evaluate whether additional files would add value:

**CLAUDE-architecture.md** - Consider when:

- Multiple architectural layers or patterns exist
- Design decisions need explanation
- Codebase has 20+ files with clear structure
- **Ask user**: "This module has [layered architecture]. Would documenting the architecture in a separate file be helpful?"

**CLAUDE-patterns.md** - Consider when:

- Codebase has established conventions not obvious from code
- Naming patterns need documentation
- Multiple developers need consistency guidance
- **Ask user**: "I noticed [error handling patterns]. Should I document these patterns separately?"

**Default Strategy: Ask, Don't Assume**

1. **Always create**: CLAUDE.md only
2. **Then ask**: "I can create additional documentation files for [architecture/patterns/testing/API]. Which would be valuable?"
3. **User decides**: Only create files user confirms are valuable
4. **Keep minimal**: Even when creating additional files, keep them tightly scoped

### 6. Generate Documentation

**For templates, see:** `templates/` directory

- `CLAUDE-template.md` - Repository-level template
- `CLAUDE-module-template.md` - Module-level template

**Key requirements:**

- Repository CLAUDE.md: Under 100 lines, usage-focused
- Module CLAUDE.md: Under 80 lines, usage-focused
- Only list commands that actually exist
- No speculation about future plans
- Cross-references must be accurate

### 7. Verification Checklist

Before completion:

- [ ] All CLAUDE.md files are under size limits
- [ ] All CLAUDE.md files focus on usage (just commands, quick start, PM details)
- [ ] No speculation or assumptions in any file
- [ ] Only documented justfile commands that actually exist
- [ ] Cross-references between files are accurate
- [ ] Committed all documentation to repository

## Quality Checks

**Did NOT:**

- [ ] Create files without user confirmation
- [ ] Include detailed architecture in CLAUDE.md
- [ ] Include code patterns in CLAUDE.md
- [ ] Speculate about future plans
- [ ] Assume conventions that don't exist

**DID:**

- [ ] Ask when unsure about file value
- [ ] Keep documentation minimal and focused
- [ ] Verify all information against actual codebase
- [ ] Follow usage-first approach

## Signal-to-Noise Optimization

**Goal:** CLAUDE documentation should maximize AI agent success rate.

**High Signal (Keep):**

- Commands that agents actually run
- Entry points agents need to modify
- Dependencies that affect agent decisions
- Project management info for creating issues/tasks
- Architecture decisions that affect how agents write code

**Low Signal (Remove/Minimize):**

- Historical context that doesn't affect current work
- Generic best practices available on Google
- Redundant information duplicated across files
- Out-of-date commands or tooling
- Wishful thinking about future architecture

## Integration with Other Skills

**May use during documentation:**

- Codebase exploration skills
- Pattern detection
- Technology stack analysis

**For comprehensive templates and update workflows, see:**

- `templates/` - Documentation templates
- `reference/detection-guide.md` - Technology detection
- `reference/update-guide.md` - Updating existing docs (when already exist)

## Remember

**Good documentation enables effective AI collaboration.**

The goal is clear communication of:

- What modules exist
- What they do
- How they relate
- How to work with them

Keep it minimal, usage-focused, and based on verified facts only.
